- job:
    name: requirements-tox-babel
    parent: openstack-tox
    description: |
      Run test for requirements project.

      Uses tox with the ``babel`` environment.
    files:
      - ^babel-test/.*
      - ^tox.ini
      - ^upper-constraints.txt
    vars:
      tox_envlist: babel

- job:
    name: requirements-tox-py27-check-uc
    parent: openstack-tox
    description: |
      Run test for requirements project.

      Uses tox with the ``py27-check-uc`` environment.
    files: ^upper-constraints.*txt$
    vars:
      tox_envlist: py27-check-uc

- job:
    name: requirements-tox-py36-check-uc
    parent: openstack-tox-py36
    description: |
      Run test for requirements project.

      Uses tox with the ``py36-check-uc`` environment.
    files: ^upper-constraints.*txt$
    vars:
      tox_envlist: py36-check-uc
- job:
    name: requirements-tox-validate-projects
    parent: openstack-tox
    files:
      - ^projects.txt
    description: |
      Run test for requirements project.

      Uses tox with the ``validate-projects`` environment.
    vars:
      tox_envlist: validate-projects

- job:
    name: requirements-tox-bindep
    parent: openstack-tox
    description: |
      Run test for requirements project.

      Uses tox with the ``bindep`` environment.
    files: ^bindep.txt$
    vars:
      tox_envlist: bindep

- job:
    name: requirements-integration
    parent: devstack
    timeout: 7800
    required-projects:
      - openstack/devstack
      - openstack/grenade
      - openstack/pbr
      - openstack/devstack-gate
      - openstack/tripleo-ci
      - openstack/aodh
      - openstack/automaton
      - openstack/ceilometer
      - openstack/ceilometermiddleware
      - openstack/cinder
      - openstack/cliff
      - openstack/debtcollector
      - openstack/dib-utils
      - openstack/diskimage-builder
      - openstack/django_openstack_auth
      - openstack/futurist
      - openstack/glance
      - openstack/glance_store
      - openstack/heat
      - openstack/heat-cfntools
      - openstack/heat-templates
      - openstack/horizon
      - openstack/ironic
      - openstack/ironic-lib
      - openstack/ironic-python-agent
      - openstack/keystone
      - openstack/keystoneauth
      - openstack/keystonemiddleware
      - openstack/manila
      - openstack/manila-ui
      - openstack/neutron
      - openstack/neutron-fwaas
      - openstack/neutron-lbaas
      - openstack/neutron-vpnaas
      - openstack/nova
      - openstack/octavia
      - openstack/os-apply-config
      - openstack/os-brick
      - openstack/os-client-config
      - openstack/os-collect-config
      - openstack/os-net-config
      - openstack/os-refresh-config
      - openstack/osc-lib
      - openstack/oslo.cache
      - openstack/oslo.concurrency
      - openstack/oslo.config
      - openstack/oslo.context
      - openstack/oslo.db
      - openstack/oslo.i18n
      - openstack/oslo.log
      - openstack/oslo.messaging
      - openstack/oslo.middleware
      - openstack/oslo.policy
      - openstack/oslo.reports
      - openstack/oslo.rootwrap
      - openstack/oslo.serialization
      - openstack/oslo.service
      - openstack/oslo.utils
      - openstack/oslo.versionedobjects
      - openstack/oslo.vmware
      - openstack/pycadf
      - openstack/python-cinderclient
      - openstack/python-glanceclient
      - openstack/python-heatclient
      - openstack/python-ironicclient
      - openstack/python-keystoneclient
      - openstack/python-manilaclient
      - openstack/python-neutronclient
      - openstack/python-novaclient
      - openstack/python-openstackclient
      - openstack/python-saharaclient
      - openstack/python-swiftclient
      - openstack/python-troveclient
      - openstack/python-zaqarclient
      - openstack/requirements
      - openstack/sahara
      - openstack/sahara-dashboard
      - openstack/stevedore
      - openstack/swift
      - openstack/taskflow
      - openstack/tempest
      - openstack/tooz
      - openstack/tripleo-heat-templates
      - openstack/tripleo-image-elements
      - openstack/trove
      - openstack/trove-dashboard
      - openstack/zaqar
    vars:
      PROJECTS: >
        { PROJECTS }
        openstack/devstack-gate
        openstack/devstack
        openstack/grenade
        openstack/pbr
        openstack/tripleo-ci
        openstack/aodh
        openstack/automaton
        openstack/ceilometer
        openstack/ceilometermiddleware
        openstack/cinder
        openstack/cliff
        openstack/debtcollector
        openstack/dib-utils
        openstack/diskimage-builder
        openstack/django_openstack_auth
        openstack/futurist
        openstack/glance
        openstack/glance_store
        openstack/heat
        openstack/heat-cfntools
        openstack/heat-templates
        openstack/horizon
        openstack/ironic
        openstack/ironic-lib
        openstack/ironic-python-agent
        openstack/keystone
        openstack/keystoneauth
        openstack/keystonemiddleware
        openstack/manila
        openstack/manila-ui
        openstack/zaqar
        openstack/neutron
        openstack/neutron-fwaas
        openstack/neutron-lbaas
        openstack/octavia
        openstack/neutron-vpnaas
        openstack/nova
        openstack/os-apply-config
        openstack/os-brick
        openstack/os-client-config
        openstack/os-collect-config
        openstack/os-net-config
        openstack/os-refresh-config
        openstack/osc-lib
        openstack/oslo.cache
        openstack/oslo.concurrency
        openstack/oslo.config
        openstack/oslo.context
        openstack/oslo.db
        openstack/oslo.i18n
        openstack/oslo.log
        openstack/oslo.messaging
        openstack/oslo.middleware
        openstack/oslo.policy
        openstack/oslo.reports
        openstack/oslo.rootwrap
        openstack/oslo.utils
        openstack/oslo.serialization
        openstack/oslo.service
        openstack/oslo.versionedobjects
        openstack/oslo.vmware
        openstack/pycadf
        openstack/python-cinderclient
        openstack/python-glanceclient
        openstack/python-heatclient
        openstack/python-ironicclient
        openstack/python-keystoneclient
        openstack/python-manilaclient
        openstack/python-zaqarclient
        openstack/python-neutronclient
        openstack/python-novaclient
        openstack/python-openstackclient
        openstack/python-saharaclient
        openstack/python-swiftclient
        openstack/python-troveclient
        openstack/requirements
        openstack/sahara
        openstack/sahara-dashboard
        openstack/stevedore
        openstack/swift
        openstack/taskflow
        openstack/tempest
        openstack/tooz
        openstack/tripleo-heat-templates
        openstack/tripleo-image-elements
        openstack/trove
        openstack/trove-dashboard
    shell: |
          function gate_hook {
              set -x
              bash $BASE/new/devstack-gate/devstack-vm-gate.sh && \
              bash -xe $BASE/new/requirements/tools/integration.sh $(cat $BASE/new/requirements/projects.txt)
          }
          export -f gate_hook
