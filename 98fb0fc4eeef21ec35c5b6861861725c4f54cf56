{
  "comments": [
    {
      "key": {
        "uuid": "bf659307_ef2c8203",
        "filename": "openstack_requirements/check.py",
        "patchSetId": 3
      },
      "lineNbr": 252,
      "author": {
        "id": 12898
      },
      "writtenOn": "2018-03-29T01:06:45Z",
      "side": 1,
      "message": "In evaluating this I found a few problems clearly I\u0027m not signing you up for fixing them and I\u0027m not sure if any of them block the l-c work but it\u0027s all intertwined, much like a tangled web of onions ;D\n\n1) We\u0027re missing some (most) environment markers from lower-constraints.txt.\n\n $ git grep python_version lower-constraints.txt | wc -l\n 5\n $ git grep python_version upper-constraints.txt | wc -l\n 46\n\n\nI know that we have other lower-constraints files out there that will need fixing ... once we decide what \u0027fixed\u0027 looks like.\n\n2) Closely related to \u00271\u0027 above we have 0 coverage of any requirement that has a marker that excludes linux.\n\n $ git grep sys_platform global-requirements.txt\n global-requirements.txt:pyinotify\u003e\u003d0.9.6;sys_platform!\u003d\u0027win32\u0027 and sys_platform!\u003d\u0027darwin\u0027 and sys_platform!\u003d\u0027sunos5\u0027  # MIT\n global-requirements.txt:pyroute2\u003e\u003d0.4.21;sys_platform!\u003d\u0027win32\u0027  # Apache-2.0 (+ dual licensed GPL2)\n global-requirements.txt:PyMI\u003e\u003d1.0.0;sys_platform\u003d\u003d\u0027win32\u0027  # Apache 2.0 License\n global-requirements.txt:wmi\u003e\u003d0.5;sys_platform\u003d\u003d\u0027win32\u0027  # MIT\n\nNow I\u0027m not sure if that\u0027s a real issue as I\u0027m not sure if the hyperv team (which seems to be the only affected group) consumes constraints and clearly it doesn\u0027t impact our CI but I noticed it and wanted to at least discuss it.\n\n3) Right now we have a couple of examples like:\n\n $ git grep unicodecsv global-requirements.txt *-constraints.txt\n global-requirements.txt:unicodecsv\u003e\u003d0.8.0;python_version\u003c\u00273.0\u0027  # BSD\n lower-constraints.txt:unicodecsv\u003d\u003d\u003d0.8.0\n upper-constraints.txt:unicodecsv\u003d\u003d\u003d0.14.1;python_version\u003d\u003d\u00272.7\u0027\n\nAnd we need to support at least that level of marker.  As _find_constraint() is checking for equality this will fail.  Now we can of course alter the way we generate our constraints files to use less precise markers \u003c\u003d\u00273.0\u0027 instead of \u003d\u003d\u00272.7\u0027 but right now I\u0027m not entirely certain *how* we do that and get it right but my intuition says we\u0027d need to always use \u003c\u00273.X\u0027 or \u003e\u003d\u00273.X\u0027 in g-r and then reflect that in u-c.  It\u0027s technically incorrect but it\u0027s no worse than what we have now.\n\nSo for this patch what we have wont work with the data we currently have.  I was hoping that we can use Marker().evaluate(environment\u003d{\u0027python_version\u0027: \u0027xxx\u0027}) but that\u0027s non-trivial due to the things I\u0027ve outlined above.",
      "revId": "98fb0fc4eeef21ec35c5b6861861725c4f54cf56",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf659307_b561e507",
        "filename": "openstack_requirements/check.py",
        "patchSetId": 3
      },
      "lineNbr": 252,
      "author": {
        "id": 2472
      },
      "writtenOn": "2018-03-29T17:35:55Z",
      "side": 1,
      "message": "See what you think of the new version. It\u0027s a bit more flexible, but isn\u0027t going to work in all cases. It does cover case 3 of your comment.",
      "parentUuid": "bf659307_ef2c8203",
      "revId": "98fb0fc4eeef21ec35c5b6861861725c4f54cf56",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf659307_8a7cbb83",
        "filename": "openstack_requirements/check.py",
        "patchSetId": 3
      },
      "lineNbr": 252,
      "author": {
        "id": 12898
      },
      "writtenOn": "2018-03-29T21:53:43Z",
      "side": 1,
      "message": "I can\u0027t say I like the use of internals but your code does what we need and you\u0027ve clearly documented that what we\u0027re doing.\n\nIt\u0027s enough to get this work merged while we discuss if/how we change our constraints implementation.\n\nThanks for being patient and tenacious Doug!",
      "parentUuid": "bf659307_b561e507",
      "revId": "98fb0fc4eeef21ec35c5b6861861725c4f54cf56",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf659307_3d02b30c",
        "filename": "openstack_requirements/check.py",
        "patchSetId": 3
      },
      "lineNbr": 290,
      "author": {
        "id": 12898
      },
      "writtenOn": "2018-03-29T01:06:45Z",
      "side": 1,
      "message": "As the pep8 job says we no longer have \u0027actual\u0027 so this should be \u0027version\u0027",
      "range": {
        "startLine": 290,
        "startChar": 36,
        "endLine": 290,
        "endChar": 42
      },
      "revId": "98fb0fc4eeef21ec35c5b6861861725c4f54cf56",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}